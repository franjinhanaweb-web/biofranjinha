<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popular C√≥digos de Verifica√ß√£o</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        h1 {
            color: #e91e63;
            text-align: center;
            margin-bottom: 2rem;
        }
        .button {
            background: linear-gradient(135deg, #e91e63 0%, #f06292 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 1rem 0;
            transition: all 0.3s ease;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(233, 30, 99, 0.3);
        }
        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .info {
            background: rgba(233, 30, 99, 0.1);
            border-left: 4px solid #e91e63;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Popular C√≥digos de Verifica√ß√£o</h1>
        
        <div class="info">
            <strong>‚ÑπÔ∏è Instru√ß√µes:</strong>
            <ol>
                <li>Certifique-se de que o Firebase est√° configurado corretamente</li>
                <li>Clique no bot√£o abaixo para criar 50 c√≥digos UUID</li>
                <li>Os c√≥digos ser√£o salvos na cole√ß√£o <code>users_codes</code></li>
                <li>Use qualquer um dos c√≥digos criados para testar o cadastro</li>
            </ol>
        </div>

        <button id="populateBtn" class="button">
            üöÄ Criar 50 C√≥digos de Verifica√ß√£o
        </button>

        <div id="log" class="log" style="display: none;"></div>

        <div class="info">
            <strong>üìã Formato dos C√≥digos:</strong><br>
            Exemplo: <code>61749772-f947-4cd8-859e-d9b6d48ea812</code><br>
            <small>Cada c√≥digo √© √∫nico e pode ser usado apenas uma vez.</small>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Importar Firebase (ajuste os caminhos conforme sua configura√ß√£o)
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, Timestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Configura√ß√£o do Firebase (substitua pelos seus valores)
        const firebaseConfig = {
            // Cole aqui sua configura√ß√£o do Firebase
            apiKey: "sua-api-key",
            authDomain: "seu-projeto.firebaseapp.com",
            projectId: "seu-projeto-id",
            storageBucket: "seu-projeto.appspot.com",
            messagingSenderId: "123456789",
            appId: "seu-app-id"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Fun√ß√£o para gerar UUID v4
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // Fun√ß√£o para log
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : '';
            logDiv.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Fun√ß√£o para popular c√≥digos
        async function populateCodes(quantity = 50) {
            const btn = document.getElementById('populateBtn');
            const logDiv = document.getElementById('log');
            
            btn.disabled = true;
            btn.textContent = '‚è≥ Criando c√≥digos...';
            logDiv.style.display = 'block';
            logDiv.innerHTML = '';

            try {
                log(`üöÄ Iniciando cria√ß√£o de ${quantity} c√≥digos...`);
                
                const codesRef = collection(db, 'users_codes');
                const codes = [];
                
                // Gerar c√≥digos √∫nicos
                const generatedCodes = new Set();
                while (generatedCodes.size < quantity) {
                    generatedCodes.add(generateUUID());
                }
                
                // Preparar documentos
                const now = Timestamp.now();
                const codesArray = Array.from(generatedCodes);
                
                for (const code of codesArray) {
                    codes.push({
                        code: code,
                        isUsed: false,
                        createdAt: now
                    });
                }
                
                // Inserir c√≥digos
                let inserted = 0;
                for (const codeDoc of codes) {
                    try {
                        await addDoc(codesRef, codeDoc);
                        inserted++;
                        if (inserted % 10 === 0) {
                            log(`‚úÖ ${inserted}/${quantity} c√≥digos inseridos...`);
                        }
                    } catch (error) {
                        log(`‚ùå Erro ao inserir c√≥digo: ${error.message}`, 'error');
                    }
                }
                
                log(`üéâ Sucesso! ${inserted} c√≥digos criados.`, 'success');
                log('üìã Exemplos de c√≥digos criados:');
                codesArray.slice(0, 5).forEach((code, index) => {
                    log(`   ${index + 1}. ${code}`);
                });
                
                log('üí° Agora voc√™ pode testar o cadastro com qualquer um desses c√≥digos.', 'success');
                
            } catch (error) {
                log(`‚ùå Erro geral: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'üöÄ Criar 50 C√≥digos de Verifica√ß√£o';
            }
        }

        // Event listener
        document.getElementById('populateBtn').addEventListener('click', () => {
            populateCodes(50);
        });

        // Aviso sobre configura√ß√£o
        if (firebaseConfig.apiKey === "sua-api-key") {
            log('‚ö†Ô∏è ATEN√á√ÉO: Configure suas credenciais do Firebase no arquivo HTML antes de usar!', 'warning');
        }
    </script>
</body>
</html>
